<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<title>Pixel Tetris Classic</title>

<style>
html,body{
  margin:0;
  padding:0;
  background:#222;
  overflow:hidden;
  touch-action:none;
  font-family:monospace;
  display:flex;
  flex-direction:column;
  align-items:center;
  height:100vh;
}

/* ---- CLASSIC FRAME ---- */
#frame{
  margin-top:12px;
  padding:14px 18px 18px 18px;
  background:#bcbcbc;
  border:4px solid #555;
  border-radius:6px;
  box-shadow:
    inset 4px 4px 0 #e5e5e5,
    inset -4px -4px 0 #8a8a8a,
    0 10px 20px rgba(0,0,0,.6);
  position:relative;
  width:fit-content;
}

/* ---- TOP HUD ---- */
#hud{
  display:flex;
  justify-content:space-between;
  align-items:center;
  margin-bottom:6px;
  padding:0 2px;
  color:#ffd800;
  text-shadow:0 0 6px #ffd800;
  font-size:12px;
}

#credits{
  text-align:right;
  line-height:1.1;
}

/* ---- CANVAS ---- */
canvas{
  display:block;
  background:#000;
  image-rendering:pixelated;
  border:3px solid #222;
}

/* ---- CONTROLS ---- */
#controls{
  width:100%;
  max-width:420px;
  margin-top:16px;
  display:flex;
  justify-content:space-between;
  padding:0 16px;
  box-sizing:border-box;
}

#leftControls{
  display:grid;
  grid-template-columns:repeat(3,60px);
  grid-template-rows:repeat(2,60px);
  gap:8px;
}
#leftControls .empty{visibility:hidden}

#rightControls{
  display:flex;
  flex-direction:column;
  gap:10px;
}

.btn{
  width:60px;
  height:60px;
  background:#666;
  color:#fff;
  border-radius:10px;
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:22px;
  user-select:none;
  box-shadow:
    inset 2px 2px 0 #999,
    inset -2px -2px 0 #444;
}
.small{
  width:52px;
  height:52px;
  font-size:16px;
}
</style>
</head>

<body>

<div id="frame">

  <!-- HUD -->
  <div id="hud">
    <div id="scoreText">SKOR 0</div>
    <div id="credits">
      MAT GAMES<br>
      by gokhantaylan
    </div>
  </div>

  <canvas id="game"></canvas>
</div>

<div id="controls">

  <div id="leftControls">
    <div class="empty"></div>
    <div class="btn" id="rotate">‚ü≥</div>
    <div class="empty"></div>

    <div class="btn" id="left">‚óÄ</div>
    <div class="btn" id="down">‚ñº</div>
    <div class="btn" id="right">‚ñ∂</div>
  </div>

  <div id="rightControls">
    <div class="btn small" id="pause">‚è∏</div>
    <div class="btn small" id="restart">‚ü≤</div>
    <div class="btn small" id="music">üéµ</div>
  </div>

</div>

<script>
const canvas=document.getElementById("game");
const ctx=canvas.getContext("2d");
const COLS=10, ROWS=20, BLOCK=24;
canvas.width=COLS*BLOCK;
canvas.height=ROWS*BLOCK;

const scoreText=document.getElementById("scoreText");

/* ---- AUDIO ---- */
let audioCtx, musicOsc, musicTimer, musicOn=true;
const melody=[659,494,523,587,523,494,440];
let noteIndex=0;

function beep(f,d){
  audioCtx ??= new AudioContext();
  const o=audioCtx.createOscillator(), g=audioCtx.createGain();
  o.type="square"; o.frequency.value=f;
  o.connect(g); g.connect(audioCtx.destination);
  o.start();
  g.gain.exponentialRampToValueAtTime(.001,audioCtx.currentTime+d);
  o.stop(audioCtx.currentTime+d);
}

function startMusic(){
  if(!musicOn||musicOsc) return;
  audioCtx ??= new AudioContext();
  musicOsc=audioCtx.createOscillator();
  const g=audioCtx.createGain();
  musicOsc.type="square";
  g.gain.value=.03;
  musicOsc.connect(g); g.connect(audioCtx.destination);
  musicOsc.start();
  musicTimer=setInterval(()=>musicOsc.frequency.value=melody[noteIndex++%melody.length],300);
}
function stopMusic(){
  musicOsc?.stop();
  musicOsc=null;
  clearInterval(musicTimer);
}

/* ---- GAME ---- */
let grid,cur,next,score,paused=false;
const PIECES=[
 {s:[[1,1,1,1]],c:"cyan"},
 {s:[[2,2],[2,2]],c:"yellow"},
 {s:[[0,3,0],[3,3,3]],c:"purple"},
 {s:[[0,4,4],[4,4,0]],c:"green"},
 {s:[[5,5,0],[0,5,5]],c:"red"},
 {s:[[6,0,0],[6,6,6]],c:"blue"},
 {s:[[0,0,7],[7,7,7]],c:"orange"}
];

function newPiece(){
 const p=PIECES[Math.random()*7|0];
 return {x:3,y:0,shape:p.s,color:p.c};
}

function reset(){
 grid=Array.from({length:ROWS},()=>Array(COLS).fill(0));
 cur=newPiece(); next=newPiece();
 score=0;
 scoreText.textContent="SKOR 0";
}
reset();

function collide(p){
 return p.shape.some((r,y)=>r.some((v,x)=>{
  if(!v) return false;
  let nx=p.x+x, ny=p.y+y;
  return ny>=ROWS||nx<0||nx>=COLS||grid[ny][nx];
 }));
}

function drawBlock(x,y,c){
 ctx.fillStyle=c;
 ctx.fillRect(x*BLOCK,y*BLOCK,BLOCK,BLOCK);
 ctx.strokeStyle="#111";
 ctx.strokeRect(x*BLOCK,y*BLOCK,BLOCK,BLOCK);
}

function draw(){
 ctx.fillStyle="#000";
 ctx.fillRect(0,0,canvas.width,canvas.height);
 grid.forEach((r,y)=>r.forEach((v,x)=>v&&drawBlock(x,y,v)));
 cur.shape.forEach((r,y)=>r.forEach((v,x)=>v&&drawBlock(cur.x+x,cur.y+y,cur.color)));
}

function drop(){
 cur.y++;
 if(collide(cur)){
  cur.y--;
  cur.shape.forEach((r,y)=>r.forEach((v,x)=>v&&(grid[cur.y+y][cur.x+x]=cur.color)));
  score+=10;
  scoreText.textContent="SKOR "+score;
  beep(300,.05);
  cur=next; next=newPiece();
 }
}

/* ---- INPUT ---- */
["left","right","down","rotate","pause","restart","music"].forEach(id=>{
 document.getElementById(id).ontouchstart=()=>{
  audioCtx?.resume(); startMusic();
  if(id==="left"){cur.x--; if(collide(cur))cur.x++}
  if(id==="right"){cur.x++; if(collide(cur))cur.x--}
  if(id==="down") drop();
  if(id==="rotate"){
   const o=cur.shape;
   cur.shape=o[0].map((_,i)=>o.map(r=>r[i]).reverse());
   if(collide(cur)) cur.shape=o;
  }
  if(id==="restart") reset();
  if(id==="pause"){paused=!paused; paused?stopMusic():startMusic()}
  if(id==="music"){musicOn=!musicOn; musicOn?startMusic():stopMusic()}
 };
});

/* ---- LOOP ---- */
let last=0,dropT=0;
function loop(t){
 if(!paused){
  dropT+=t-last;
  if(dropT>700){drop(); dropT=0}
 }
 last=t; draw();
 requestAnimationFrame(loop);
}
loop();
</script>

</body>
</html>